# BATTLESHIPS
## ΙΟΡΔΑΝΗΣ ΚΥΡΙΑΖΙΔΗΣ
### ADISE23_154479
    


# ΙΣΤΟΣΕΛΙΔΑ  
https://users.iee.ihu.gr/~it154479/ADISE23_154479/www/  
  
    
# Εγκατάσταση

## Απαιτήσεις

* Apache2
* Mysql Server
* php

## Οδηγίες Εγκατάστασης

 * Κάντε clone το project σε κάποιον φάκελο <br/>
  `gh repo clone iee-ihu-gr-course1941/ADISE23_154479`

 * Βεβαιωθείτε ότι ο φάκελος είναι προσβάσιμος από τον Apache Server. πιθανόν να χρειαστεί να καθορίσετε τις παρακάτω ρυθμίσεις.

 * Θα πρέπει να δημιουργήσετε στην Mysql την βάση με όνομα 'adise21' και να φορτώσετε σε αυτήν την βάση τα δεδομένα από το αρχείο schema.sql

 * Θα πρέπει να φτιάξετε το αρχείο lib/config_local.php το οποίο να περιέχει:
```
    <?php
	$DB_PASS = 'κωδικός';
	$DB_USER = 'όνομα χρήστη';
    ?>
```


# ΠΕΡΙΓΡΑΦΗ ΠΑΙΧΝΙΔΙΟΥ

Το παιχνίδι ναυμαχία παίζεται από δύο παίκτες.  

Ο κάθε παίκτης έχει ένα πίνακα/δίκτυο Projection όπου τοποθετεί τα 5 πλοία του και ένα δεύτερο πίνακα/δίκτυο Targets που αντιπροσωπεύει το δίκτυο του αντιπάλου.  
Εκεί ο παίκτης βλέπει τα αποτελέσματα των χτυπημάτων του προς τα πλοία του αντιπάλου.  

Στην αρχή και οι δύο παίκτες τοποθετούν τα πλοία τους μέσα στα όρια του πίνακα. Η τοποθέτηση γίνεται μέσω input όπου ο παίκτης δίνει το όνομα του πλοίου και τις συντεταγμένες αρχή και τέλους. Κάθε κελί χωράει μόνο ένα μέρος ενός πλοίου. Τα πλοία έχουν συγκεκριμένο μέγεθος/αριθμό κελιών που καταλαμβάνει.  

Αφού έχουν τοποθετηθεί όλα τα πλοία ξεκινάει η μάχη. Κάθε παίκτης στον γύρο του έχει τουλάχιστον ένα χτύπημα διαθέσιμο. Ο παίκτης δηλώνει τις συντεταγμένες X & Y του πλέγματος για το χτύπημα.  
Οι συντεταγμένες αυτές είναι ένα κελί του πίνακα και ένα μέρος του πλοίου αν έχει τοποθετηθεί εκεί.
Αν οι συντεταγμένες αυτές περιέχουν σκάφος στον πίνακα του αντιπάλου, τότε ο πίνακας αναπαράσταση του αντιπάλου ενημερώνεται με ένα χτύπημα σε αυτές τις συντεταγμένες.  
Μετά από κάθε πετυχημένο χτύπημα ο παίκτης δικαιούται ακόμα ένα χτύπημα.
Αν δεν υπάρχει σκάφος εκεί, στον πίνακα αναπαράσταση σημειώνεται η αποτυχία. Ο γύρος του παίκτη τελειώνει και παίζει ο επόμενος.

Νικητής είναι ο πάικτης που βυθίσει πρώτος όλα τα μέρη των πλοίων του αντιπάλου.   
  
Τα πλοία:  
* Destroyer size: 2
* Submarine size: 3
* Carrier size:5
* Cruiser size: 3
* Battleship Size: 4
  
H βάση **battleships** έχει τους πίνακες:  
* game_status, κατάσταση παιχνιδιού
* projection, πλέγμα τοποθέτησης πλοίων
* targets, πλέγμα στόχων/πλοίων αντιπάλου
* ships, πλοία
* players, παίκτες  

 και τις μεθόδους 
* clean_all, αρχικοποίηση/καθάρισμα πινάκων  
* set_piece, τοποθέτηση πλοίου  
* hit_piece, χτύπημα πλοίου αντιπάλου. 
  
    
      
# ΠΕΡΙΓΡΑΦΗ API    
  

## Projection & Targets
**Ανάγνωση Πινάκων Projection & Targets**
``` 
GET /projection/
```  
 Επιστρέφει τα περιεχόμενο των πινάκων projection & targets για τον συγκεκριμένο παίκτη δηλαδή τις συντεταγμένες και το περιεχόμενο τους.    
   
   
**Αρχικοποίηση Παιχνιδιού**   
``` 
POST /projection/
```   
Αρχικοποιεί όλα τα στοιχεία του παιχνιδιού / Reset. Επιστρέφει στην αρχική σελίδα του παιχνιδιού.  
    

## Game Status  
**Ανάγνωση Πίνακα Game Status**
```  
GET /game_status/  
```  
Επιστρέφει το περιεχόμενο του πίνακα game status δηλαδή την κατάσταση του παιχνιδιού, τον γύρο και την τελευταία ενημέρωση.    
  

**Ενημέρωση Game Status σε Ships Placed**
```
GET /game_status/placed_ships
```
Έλεγχος αν έχουν τοποθετηθεί όλα τα πλοία του παίκτη και επιστροφή του game status/    
  
  
## Players  
**Εισαγωγή παικτών**  
```
PUT /players/:p  
```  
Εισαγωγή στοιχείων παίκτη. Όνομα, αριθμός παίκτη και ένα ξεχωριστό token που δημιουργείται για κάθε παίκτη. Το token θα χρησιμοποιείται για τις αιτήσεις το παίκτη στο παιχνίδι.  
Έλεγχος για έγκυρες τιμές. Επιστρέφει το ενημερωμένο game status.  

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `username`        | Όνομα παίκτη                | yes        |
| `player_id`       | Αριθμός παίκτη              | yes        |    
     

## Ships
**Ανάγνωση Πίνακα Ships**
``` 
GET /ships/
```
Επιστρέφει τα πλοία και πληροφορίες (ονόματα, μεγέθη) από τη βάση δεδομένων.    

  
**Τοποθέτηση πλοίου**  
```  
PUT /ships/ship_name/:s
```  
Εισαγωγή στοιχείων πλοίου. Ο παίκτης στέλνει το όνομα του πλοίου s. Επιστρέφει στοιχεία του πλοίου που θέλουμε να τοποθετήσουμε. Γίνεται έλεγχος αν έχουν δωθεί έγκυρες τιμές στις συντεταγμένες.    
Επιστρέφει και την νέα κατάσταση του πίνακα projection.  
JSON DATA: οι συντεταγμένες που θα τοποθετηθεί το πλοίο.  

| Field             | Description                 | Required   |
| ----------------- | --------------------------- | ---------- |
| `start_row`       | Αρχή άξονα Χ                | yes        |
| `start_col`       | Αρχή άξονα Υ                | yes        |      
| `end_row`         | Τέλος άξονα Χ               | yes        |
| `end_col`         | Τέλος άξονα Υ               | yes        |  
    
     
**Χτύπημα πλοίου αντιπάλου**  
```
GET /ships/hit_ship/:x/:y  
```  
Αποστολή των συντεταγμένων x & y για να γίνει έλεγχος αν υπάρχει πλοίο αντιπάλου σε αυτές τις συντεταγμένες. Γίνεται έλεγχος για έγκυρες τιμές συντεταγμένων.  
Επιστρέφει αν το χτύπημα ήταν πετυχημένο ή οχι στον πίνακα targets του παίκτη.  
  
# ENTITIES 
  
### game_status  
---------    
H κατάσταση παιχνιδιού έχει τα παρακάτω στοιχεία:  
  
| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `game_id  `              | Ταυτότητα Παιχνιδιού                         | 1,2    |
| `game_stat  `            | Κατάσταση                                    | 'not active', 'initialized', 'started', 'ships_placed', 'ended', 'aborded'     |
| `p_turn`                 | To νούμερ του παίκτη που παίζει              | '1','2',null                              |
| `result`                 | To νούμερ του παίκτη που κέρδισε             |'1st Player Wins!', '2nd Player Wins!', null                              |
| `last_change`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παιχνιδιού         | timestamp |
  
  
### players  
---------   
Στοιχεία κάθε παίκτη:  
  
| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `player_id`              | Ταυτότητα παίκτη                             | 1,2                                 |
| `username`               | Όνομα παίκτη                                 | String                              |
| `token  `                | To κρυφό token του παίκτη. Δημιουργείται μόνο τη στιγμή της εισόδου του παίκτη στο παιχνίδι | HEX |  
| `last_action`            | Τελευταία αλλαγή/ενέργεια στην κατάσταση του παίκτη         | timestamp |
  
    
### projection  
---------   
Πίνακας/ ταμπλό τοποθέτησης πλοίων:  
  
| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `projection_id`          | Ταυτότητα πίνακα  projection                 | 1,2                                |
| `player_id`              | Ταυτότητα παίκτη                             | 1,2                                |
| `x_p`                    | H συντεταγμένη x του κελιού                  | 1..10                                |
| `y_p`                    | H συντεταγμένη y του κελιού                  | 1..10                                |
| `cell_status`            | Δείκτης διαθεσιμότητας κελιού                | null,1                             |
| `ship_name`              | Όνομα πλοίου στο κελί                        | String, null                       |

  
### targets
---------   
Πίνακας/ ταμπλό πλοίων αντιπάλου:   
  
| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `target_id`              | Ταυτότητα πίνακα  target                     | 1,2                                |
| `player_id`              | Ταυτότητα παίκτη                             | 1,2                                |
| `target_status`          | Δείκτης κατάστασης χτυπήματος κελιού         | 'not_specified', 'hit', 'miss'                             |
| `x_t`                    | H συντεταγμένη x του κελιού                  | 1..10                                |
| `y_t`                    | H συντεταγμένη y του κελιού                  | 1..10                                |
| `cell_status`            | Δείκτης διαθεσιμότητας κελιού                | null,1                             |
  
  
### ships  
---------   
Στοιχεία κάθε πλοίου:  
  
| Attribute                | Description                                  | Values                              |
| ------------------------ | -------------------------------------------- | ----------------------------------- |
| `ship_id`                | Ταυτότητα πλοίου                             | 1...10                                |
| `player_id`              | Ταυτότητα παίκτη                             | 1,2                                |
| `ship_name`              | Όνομα πλοίου                                 | String                       |
| `ship_size`                    |Μέγεθος πλοίου                          | Int                               |
| `start_row`       | Αρχή άξονα Χ                                        | 1...10, null       |
| `start_col`       | Αρχή άξονα Υ                                        | 1...10, null        |      
| `end_row`         | Τέλος άξονα Χ                                       | 1...10, null     |
| `end_col`         | Τέλος άξονα Υ                                       | 1...10, null     |  
